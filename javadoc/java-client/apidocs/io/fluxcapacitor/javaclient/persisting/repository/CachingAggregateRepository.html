<!DOCTYPE HTML>
<html lang>
<head>
<meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<!-- Generated by javadoc (21) on Sat Jul 26 22:56:19 UTC 2025 -->
<title>CachingAggregateRepository (io.flux-capacitor:java-client 0.1217.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-07-26">
<meta name="description" content="declaration: package: io.fluxcapacitor.javaclient.persisting.repository, class: CachingAggregateRepository">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/CachingAggregateRepository.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.fluxcapacitor.javaclient.persisting.repository</a></div>
<h1 title="Class CachingAggregateRepository" class="title">Class CachingAggregateRepository</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">io.fluxcapacitor.javaclient.persisting.repository.CachingAggregateRepository</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">CachingAggregateRepository</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></span></div>
<div class="block">A wrapper around a delegate <a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository"><code>AggregateRepository</code></a> that ensures cached aggregates stay in sync with the event
 log.
 <p>
 This repository starts an internal <a href="../../tracking/client/TrackingClient.html" title="interface in io.fluxcapacitor.javaclient.tracking.client"><code>TrackingClient</code></a> that tails the
 global event log. It deserializes received events and applies them to any corresponding aggregate in the cache,
 thereby ensuring that all cached aggregates reflect the latest known state.

 <p>This design makes it possible to load up-to-date aggregates within event and notification handlers, allowing
 these types of handlers to rely on the event model as a read model. This enables event-sourced read models without
 requiring the developer to maintain separate query-oriented state.

 <p>Specifically, when an event handler loads an aggregate, the repository first ensures that all events up to and
 including the event being handled have been processed by the tracker and applied to the cache. This prevents race
 conditions and stale reads.

 <p>If a cache miss occurs, the aggregate is loaded from the delegate repository and cached for future access.

 <h2 id="features-heading">Features</h2>
 <ul>
   <li>Transparent event replay on cached aggregates.</li>
   <li>Ensures correct ordering and consistency during event handling via index synchronization.</li>
   <li>Relationship metadata is kept up to date using <code>Relationship</code> updates.</li>
   <li>Configurable slow-tracking detection via <a href="#slowTrackingThreshold"><code>slowTrackingThreshold</code></a> (default 10 seconds).</li>
 </ul>

 <p>This caching repository is enabled by default in all Flux Capacitor applications to support aggregate access
 during event processing. If needed, it can be disabled using
 <a href="../../configuration/FluxCapacitorBuilder.html#disableAutomaticAggregateCaching()"><code>FluxCapacitorBuilder.disableAutomaticAggregateCaching()</code></a>, in which case aggregate state will not be tracked
 or kept in sync automatically, and developers are expected to manage consistency manually.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository"><code>AggregateRepository</code></a></li>
<li><a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling"><code>Entity</code></a></li>
<li><a href="../../tracking/client/TrackingClient.html" title="interface in io.fluxcapacitor.javaclient.tracking.client"><code>TrackingClient</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Duration.html" title="class or interface in java.time" class="external-link">Duration</a></code></div>
<div class="col-second even-row-color"><code><a href="#slowTrackingThreshold" class="member-name-link">slowTrackingThreshold</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">CachingAggregateRepository</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#asEntity(T)" class="member-name-link">asEntity</a><wbr>(T&nbsp;entityId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Wrap an existing aggregate instance into an <a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling"><code>Entity</code></a>, initializing tracking and identity information.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#catchUpIfNeeded()" class="member-name-link">catchUpIfNeeded</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#deleteAggregate(java.lang.Object)" class="member-name-link">deleteAggregate</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Deletes the persisted state for an aggregate, including its events or document and relationships.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getAggregatesFor(java.lang.Object)" class="member-name-link">getAggregatesFor</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;entityId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a map of aggregate IDs and their types that are associated with a given entity ID.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleEvents(java.util.List)" class="member-name-link">handleEvents</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;io.fluxcapacitor.common.api.SerializedMessage&gt;&nbsp;messages)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#load(java.lang.Object,java.lang.Class)" class="member-name-link">load</a><wbr>(@NonNull <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;T&gt;&nbsp;type)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Load an aggregate by its identifier and type.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#loadFor(java.lang.Object,java.lang.Class)" class="member-name-link">loadFor</a><wbr>(@NonNull <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;entityId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;defaultType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Load the aggregate that owns the specified entity.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#repairRelationships(io.fluxcapacitor.javaclient.modeling.Entity)" class="member-name-link">repairRelationships</a><wbr>(<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;?&gt;&nbsp;aggregate)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Repairs the internal relationship model for a loaded aggregate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#startTrackerIfNeeded()" class="member-name-link">startTrackerIfNeeded</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#updateRelationships(io.fluxcapacitor.javaclient.modeling.Entity,io.fluxcapacitor.javaclient.modeling.Entity)" class="member-name-link">updateRelationships</a><wbr>(<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;?&gt;&nbsp;before,
 <a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;?&gt;&nbsp;after)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-io.fluxcapacitor.javaclient.persisting.repository.AggregateRepository">Methods inherited from interface&nbsp;io.fluxcapacitor.javaclient.persisting.repository.<a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></h3>
<code><a href="AggregateRepository.html#getLatestAggregateId(java.lang.Object)">getLatestAggregateId</a>, <a href="AggregateRepository.html#load(io.fluxcapacitor.javaclient.modeling.Id)">load</a>, <a href="AggregateRepository.html#repairRelationships(io.fluxcapacitor.javaclient.modeling.Id)">repairRelationships</a>, <a href="AggregateRepository.html#repairRelationships(java.lang.Object)">repairRelationships</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="slowTrackingThreshold">
<h3>slowTrackingThreshold</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Duration.html" title="class or interface in java.time" class="external-link">Duration</a></span>&nbsp;<span class="element-name">slowTrackingThreshold</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>CachingAggregateRepository</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">CachingAggregateRepository</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="load(java.lang.Object,java.lang.Class)">
<h3>load</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;T&gt;</span>&nbsp;<span class="element-name">load</span><wbr><span class="parameters">(@NonNull
 @NonNull <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;T&gt;&nbsp;type)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="AggregateRepository.html#load(java.lang.Object,java.lang.Class)">AggregateRepository</a></code></span></div>
<div class="block">Load an aggregate by its identifier and type.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRepository.html#load(java.lang.Object,java.lang.Class)">load</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
<dt>Type Parameters:</dt>
<dd><code>T</code> - the aggregate type.</dd>
<dt>Parameters:</dt>
<dd><code>aggregateId</code> - the aggregate identifier.</dd>
<dd><code>type</code> - the expected class type.</dd>
<dt>Returns:</dt>
<dd>the loaded aggregate wrapped in an <a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling"><code>Entity</code></a>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="loadFor(java.lang.Object,java.lang.Class)">
<h3>loadFor</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;T&gt;</span>&nbsp;<span class="element-name">loadFor</span><wbr><span class="parameters">(@NonNull
 @NonNull <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;entityId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;defaultType)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="AggregateRepository.html#loadFor(java.lang.Object,java.lang.Class)">AggregateRepository</a></code></span></div>
<div class="block">Load the aggregate that owns the specified entity.
 <p>
 If no ownership is found in the relationship index, this method may fall back to loading the entity as if it were
 an aggregate itself.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRepository.html#loadFor(java.lang.Object,java.lang.Class)">loadFor</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
<dt>Type Parameters:</dt>
<dd><code>T</code> - the aggregate type.</dd>
<dt>Parameters:</dt>
<dd><code>entityId</code> - the child or nested entity.</dd>
<dd><code>defaultType</code> - fallback type to use when no aggregate mapping is available.</dd>
<dt>Returns:</dt>
<dd>the loaded aggregate as an <a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling"><code>Entity</code></a>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="asEntity(T)">
<h3 id="asEntity(java.lang.Object)">asEntity</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;T&gt;</span>&nbsp;<span class="element-name">asEntity</span><wbr><span class="parameters">(T&nbsp;entityId)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="AggregateRepository.html#asEntity(T)">AggregateRepository</a></code></span></div>
<div class="block">Wrap an existing aggregate instance into an <a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling"><code>Entity</code></a>, initializing tracking and identity information.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRepository.html#asEntity(T)">asEntity</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
<dt>Type Parameters:</dt>
<dd><code>T</code> - the aggregate type.</dd>
<dt>Parameters:</dt>
<dd><code>entityId</code> - the aggregate instance.</dd>
<dt>Returns:</dt>
<dd>the entity wrapper.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="repairRelationships(io.fluxcapacitor.javaclient.modeling.Entity)">
<h3>repairRelationships</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">repairRelationships</span><wbr><span class="parameters">(<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;?&gt;&nbsp;aggregate)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="AggregateRepository.html#repairRelationships(io.fluxcapacitor.javaclient.modeling.Entity)">AggregateRepository</a></code></span></div>
<div class="block">Repairs the internal relationship model for a loaded aggregate.
 <p>
 This is useful when refactoring entity hierarchies or recovering from inconsistent relationship state.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRepository.html#repairRelationships(io.fluxcapacitor.javaclient.modeling.Entity)">repairRelationships</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
<dt>Parameters:</dt>
<dd><code>aggregate</code> - the aggregate to inspect.</dd>
<dt>Returns:</dt>
<dd>a future that completes when the relationships are updated.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getAggregatesFor(java.lang.Object)">
<h3>getAggregatesFor</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&gt;</span>&nbsp;<span class="element-name">getAggregatesFor</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;entityId)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="AggregateRepository.html#getAggregatesFor(java.lang.Object)">AggregateRepository</a></code></span></div>
<div class="block">Returns a map of aggregate IDs and their types that are associated with a given entity ID.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRepository.html#getAggregatesFor(java.lang.Object)">getAggregatesFor</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
<dt>Parameters:</dt>
<dd><code>entityId</code> - the child or nested entity.</dd>
<dt>Returns:</dt>
<dd>a map of aggregate IDs to class names.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteAggregate(java.lang.Object)">
<h3>deleteAggregate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">deleteAggregate</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="AggregateRepository.html#deleteAggregate(java.lang.Object)">AggregateRepository</a></code></span></div>
<div class="block">Deletes the persisted state for an aggregate, including its events or document and relationships.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRepository.html#deleteAggregate(java.lang.Object)">deleteAggregate</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRepository.html" title="interface in io.fluxcapacitor.javaclient.persisting.repository">AggregateRepository</a></code></dd>
<dt>Parameters:</dt>
<dd><code>aggregateId</code> - the ID of the aggregate to delete.</dd>
<dt>Returns:</dt>
<dd>a future that completes when deletion has been confirmed.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="handleEvents(java.util.List)">
<h3>handleEvents</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleEvents</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;io.fluxcapacitor.common.api.SerializedMessage&gt;&nbsp;messages)</span></div>
</section>
</li>
<li>
<section class="detail" id="updateRelationships(io.fluxcapacitor.javaclient.modeling.Entity,io.fluxcapacitor.javaclient.modeling.Entity)">
<h3>updateRelationships</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">updateRelationships</span><wbr><span class="parameters">(<a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;?&gt;&nbsp;before,
 <a href="../../modeling/Entity.html" title="interface in io.fluxcapacitor.javaclient.modeling">Entity</a>&lt;?&gt;&nbsp;after)</span></div>
</section>
</li>
<li>
<section class="detail" id="catchUpIfNeeded()">
<h3>catchUpIfNeeded</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">catchUpIfNeeded</span>()</div>
</section>
</li>
<li>
<section class="detail" id="startTrackerIfNeeded()">
<h3>startTrackerIfNeeded</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">startTrackerIfNeeded</span>()</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025 <a href="https://github.com/flux-capacitor-io/flux-capacitor-client">Flux Capacitor</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
